{"version":3,"file":"doctor.js","names":["getSortedObject","obj","Array","isArray","keys","Object","sort","newObj","addedKeys","forEach","v","checkForDuplicates","arr","dupCheck","k","logWarning","chalk","white","fixPackageJson","c","pkgPath","Promise","resolve","reject","pth","paths","project","package","pp","readObjectSync","output","fixPackageObject","writeFileSync","usedKeys","PACKAGE_JSON_FILEDS","dependencies","devDependencies"],"sources":["../../src/systemTools/doctor.js"],"sourcesContent":["import chalk from 'chalk';\nimport { writeFileSync, readObjectSync } from './fileutils';\nimport { PACKAGE_JSON_FILEDS } from '../constants';\nimport { logWarning } from './logger';\n\nconst getSortedObject = (obj) => {\n    if (obj !== null && typeof obj === 'object' && !Array.isArray(obj)) {\n        const keys = Object.keys(obj).sort();\n        const newObj = {};\n        const addedKeys = {};\n        keys.forEach((v) => {\n            if (!addedKeys[v]) {\n                newObj[v] = obj[v];\n                addedKeys[v] = true;\n            } else {\n\n            }\n        });\n        return newObj;\n    } if (Array.isArray(obj)) {\n        return obj.sort();\n    }\n    return obj;\n};\n\nconst checkForDuplicates = (arr) => {\n    const dupCheck = {};\n    arr.forEach((v) => {\n        if (v) {\n            for (const k in v) {\n                if (dupCheck[k]) {\n                    logWarning(`Key ${chalk.white(k)} is duplicated in your package.json`);\n                }\n                dupCheck[k] = true;\n            }\n        }\n    });\n};\n\nconst fixPackageJson = (c, pkgPath) => new Promise((resolve, reject) => {\n    const pth = pkgPath || c.paths.project.package;\n    const pp = readObjectSync(pth);\n    const output = fixPackageObject(pp);\n    writeFileSync(pth, output, 4);\n    resolve();\n});\n\nconst fixPackageObject = (pp) => {\n    const output = {};\n    const usedKeys = {};\n    PACKAGE_JSON_FILEDS.forEach((v) => {\n        if (pp[v] !== null) {\n            output[v] = getSortedObject(pp[v]);\n            usedKeys[v] = true;\n        }\n    });\n    for (const k in pp) {\n        if (!usedKeys[k]) {\n            output[k] = pp[k];\n        }\n    }\n    checkForDuplicates([pp.dependencies, pp.devDependencies]);\n\n    return output;\n};\n\nexport { fixPackageJson, fixPackageObject };\nexport default {\n    fixPackageJson, fixPackageObject\n};\n"],"mappings":"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"}