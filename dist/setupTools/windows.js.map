{"version":3,"sources":["../../src/setupTools/windows.js"],"names":["LinuxPlatformSetup","c","scoopInstalled","os","availableDownloader","software","shell","exec","reloadPathEnv","bucket","installSoftware","addScoopBucket","androidSdkLocation","sdksToInstall","downloadDir","setupConfig","tizen","downloadLocation","split","pop","join","inquirer","prompt","type","name","message","default","validate","value","fs","existsSync","res","path","sdkPath","tizenSdkPath","downloadLink","webos","openCommand","webosSdkPath","BasePlatformSetup"],"mappings":"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","sourcesContent":["import shell from 'shelljs';\nimport { getInstalledPathSync } from 'get-installed-path';\nimport path from 'path';\nimport { exec } from 'child_process';\nimport inquirer from 'inquirer';\nimport fs from 'fs';\n\nimport { commandExistsSync, executeAsync, openCommand } from '../systemTools/exec';\nimport { logInfo, logDebug } from '../systemTools/logger';\nimport { replaceHomeFolder } from '../systemTools/fileutils';\nimport BasePlatformSetup from './base';\nimport setupConfig from './config';\n\nclass LinuxPlatformSetup extends BasePlatformSetup {\n    constructor(c) {\n        super('win32', c);\n        this.scoopInstalled = false;\n    }\n\n    checkPrereqs() {\n        logInfo(`Platform ${this.os}`);\n        logInfo('Checking wget is installed');\n        if (commandExistsSync('wget')) {\n            this.availableDownloader = 'wget';\n        }\n\n        // check if scoop is installed\n        if (commandExistsSync('scoop')) {\n            this.scoopInstalled = true;\n        }\n    }\n\n    async installSoftware(software) {\n        await shell.exec(replaceHomeFolder(`~/scoop/shims/scoop install ${software}`));\n        await this.reloadPathEnv();\n        return true;\n    }\n\n    addScoopBucket(bucket) {\n        return shell.exec(replaceHomeFolder(`~/scoop/shims/scoop bucket add ${bucket}`));\n    }\n\n    async reloadPathEnv() {\n        await shell.exec(`${getInstalledPathSync('rnv')}/scripts/resetPath.vbs`);\n        await shell.exec('%TEMP%/resetvars.bat');\n        return true;\n    }\n\n    async installPrereqs() {\n        if (!this.scoopInstalled) {\n            logInfo('Installing Scoop...');\n            await shell.exec(`powershell -executionpolicy remotesigned \"& \"\"${getInstalledPathSync('rnv')}/scripts/installPackageManager.ps1\"\"\"`);\n            await this.reloadPathEnv();\n        }\n        if (!this.availableDownloader) {\n            logInfo('Looks like you don\\'t have wget or curl installed. We\\'ll install wget for you');\n            await this.installSoftware('wget');\n            this.availableDownloader = 'wget';\n        }\n\n        if (!commandExistsSync('unzip')) {\n            logInfo('Looks like you don\\'t have unzip installed. We\\'ll install it for you');\n            await this.installSoftware('unzip');\n        }\n\n        if (!commandExistsSync('javac')) {\n            logInfo('Looks like you don\\'t have java installed. We\\'ll install it for you');\n            await this.installSoftware('shellcheck');\n            await this.addScoopBucket('java');\n            await this.installSoftware('ojdkbuild8');\n        }\n\n        return true;\n    }\n\n    async installSdksAndEmulator() {\n        logDebug('Accepting licenses');\n        await executeAsync({}, `${this.androidSdkLocation}/tools/bin/sdkmanager.bat --licenses`);\n        logDebug('Installing SDKs', this.sdksToInstall);\n        await executeAsync({}, `${this.androidSdkLocation}/tools/bin/sdkmanager.bat ${this.sdksToInstall}`);\n    }\n\n    async installTizenSdk() {\n        let downloadDir = setupConfig.tizen.downloadLocation.split('/');\n        downloadDir.pop();\n        downloadDir = downloadDir.join('/');\n        logInfo(`Opening ${downloadDir}. Please install the SDK then continue after it finished installing.`);\n        exec(`start \"\" \"${downloadDir}\"`);\n\n        const res = await inquirer.prompt({\n            type: 'input',\n            name: 'sdkPath',\n            message: \"Where did you install the SDK? (if you haven't changed the default just press enter)\",\n            default: 'C:\\\\tizen-studio',\n            validate(value) {\n                if (fs.existsSync(value)) return true;\n                return 'Path does not exist';\n            }\n        });\n\n        await inquirer.prompt({\n            type: 'confirm',\n            name: 'toolsInstalled',\n            message: 'Please open Package Manager and install: Tizen SDK Tools (Main SDK), TV Extensions-* (Extension SDK). Continue after you finished installing them.',\n            validate() {\n                return fs.existsSync(path.join(res.sdkPath, 'tools/ide/bin/tizen.bat')) || 'This does not look like a Tizen SDK path';\n            }\n        });\n\n        this.tizenSdkPath = res.sdkPath;\n    }\n\n    async installWebosSdk() {\n        const { downloadLink } = setupConfig.webos;\n        logInfo(`Opening ${downloadLink}. Please download and install the SDK then continue after it finished installing. Make sure you also install the CLI and Emulator components`);\n        exec(`${openCommand} ${downloadLink}`);\n        const res = await inquirer.prompt({\n            type: 'input',\n            name: 'sdkPath',\n            message: \"Where did you install the SDK? (if you haven't changed the default just press enter)\",\n            default: 'C:\\\\webOS_TV_SDK',\n            validate(value) {\n                if (fs.existsSync(value)) return true;\n                return 'Path does not exist';\n            }\n        });\n\n        await inquirer.prompt({\n            type: 'confirm',\n            name: 'toolsInstalled',\n            message: 'Are the CLI and Emulator components installed?',\n            validate() {\n                return fs.existsSync(path.join(res.sdkPath, 'tools/ide/bin/tizen.bat')) || 'This does not look like a Tizen SDK path';\n            }\n        });\n\n        this.webosSdkPath = res.sdkPath;\n    }\n}\n\nexport default LinuxPlatformSetup;\n"],"file":"windows.js"}