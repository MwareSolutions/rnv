{"version":3,"file":"sdkManager.js","names":["homedir","require","SDK_LOACTIONS","android","path","join","tizen","webos","_logSdkWarning","c","logWarning","paths","workspace","config","checkAndConfigureAndroidSdks","logTask","platform","sdk","files","sdks","ANDROID_SDK","cli","CLI_ANDROID_EMULATOR","getRealPath","isSystemWin","CLI_ANDROID_ADB","CLI_ANDROID_AVDMANAGER","CLI_ANDROID_SDKMANAGER","checkAndConfigureTizenSdks","TIZEN_SDK","CLI_TIZEN_EMULATOR","CLI_TIZEN","CLI_SDB_TIZEN","checkAndConfigureWebosSdks","WEBOS_SDK","CLI_WEBOS_ARES","CLI_WEBOS_ARES_PACKAGE","CLI_WEBOS_ARES_INSTALL","CLI_WEBOS_ARES_LAUNCH","CLI_WEBOS_ARES_SETUP_DEVICE","CLI_WEBOS_ARES_DEVICE_INFO","CLI_WEBOS_ARES_NOVACOM","checkAndConfigureSdks","ANDROID","ANDROID_TV","ANDROID_WEAR","TIZEN","TIZEN_MOBILE","TIZEN_WATCH","WEBOS","_getCurrentSdkPath","SDK_PLATFORMS","_isSdkInstalled","sdkPath","fs","existsSync","_attemptAutoFix","engine","result","find","v","logSuccess","chalk","white","inquirer","prompt","type","name","message","confirm","writeFileSync","logError","setupInstance","PlatformSetup","askToInstallSDK","checkSdk"],"sources":["../../src/platformTools/sdkManager.js"],"sourcesContent":["import path from 'path';\nimport fs from 'fs';\nimport chalk from 'chalk';\nimport inquirer from 'inquirer';\nimport {\n    CLI_ANDROID_EMULATOR,\n    CLI_ANDROID_AVDMANAGER,\n    CLI_ANDROID_SDKMANAGER,\n    CLI_ANDROID_ADB,\n    CLI_TIZEN_EMULATOR,\n    CLI_TIZEN,\n    CLI_SDB_TIZEN,\n    CLI_WEBOS_ARES,\n    CLI_WEBOS_ARES_PACKAGE,\n    CLI_WEBOS_ARES_INSTALL,\n    CLI_WEBOS_ARES_LAUNCH,\n    CLI_WEBOS_ARES_NOVACOM,\n    CLI_WEBOS_ARES_SETUP_DEVICE,\n    CLI_WEBOS_ARES_DEVICE_INFO,\n    ANDROID,\n    TIZEN,\n    WEBOS,\n    ANDROID_TV,\n    ANDROID_WEAR,\n    TIZEN_MOBILE,\n    TIZEN_WATCH,\n    SDK_PLATFORMS\n} from '../constants';\nimport { isSystemWin } from '../utils';\nimport {\n    getRealPath, writeFileSync\n} from '../systemTools/fileutils';\nimport {\n    logTask, logWarning, logSuccess, logError\n} from '../systemTools/logger';\nimport PlatformSetup from '../setupTools';\n\nconst homedir = require('os').homedir();\n\nconst SDK_LOACTIONS = {\n    android: [\n        path.join('usr/local/android-sdk'),\n        path.join(homedir, 'Library/Android/sdk'),\n        path.join(homedir, 'AppData/Local/Android/android-sdk'),\n        path.join(homedir, 'AppData/Local/Android/sdk'),\n        path.join('Program Files (x86)/Android/android-sdk')\n    ],\n    tizen: [\n        path.join('usr/local/tizen-studio'),\n        path.join(homedir, 'tizen-studio')\n    ],\n    webos: [\n        path.join('/opt/webOS_TV_SDK')\n    ]\n};\n\nconst _logSdkWarning = (c) => {\n    logWarning(`Your ${c.paths.workspace.config} is missing SDK configuration object`);\n};\n\nexport const checkAndConfigureAndroidSdks = async (c) => {\n    logTask(`checkAndConfigureAndroidSdks:${c.platform}`);\n    const sdk = c.files.workspace.config?.sdks?.ANDROID_SDK;\n    if (sdk) {\n        c.cli[CLI_ANDROID_EMULATOR] = getRealPath(c, path.join(sdk, `emulator/emulator${isSystemWin ? '.exe' : ''}`));\n        c.cli[CLI_ANDROID_ADB] = getRealPath(c, path.join(sdk, `platform-tools/adb${isSystemWin ? '.exe' : ''}`));\n        c.cli[CLI_ANDROID_AVDMANAGER] = getRealPath(c, path.join(sdk, `tools/bin/avdmanager${isSystemWin ? '.bat' : ''}`));\n        c.cli[CLI_ANDROID_SDKMANAGER] = getRealPath(c, path.join(sdk, `tools/bin/sdkmanager${isSystemWin ? '.bat' : ''}`));\n    } else {\n        _logSdkWarning(c);\n    }\n};\n\nexport const checkAndConfigureTizenSdks = async (c) => {\n    logTask(`checkAndConfigureTizenSdks:${c.platform}`);\n    const sdk = c.files.workspace.config?.sdks?.TIZEN_SDK;\n    if (sdk) {\n        c.cli[CLI_TIZEN_EMULATOR] = getRealPath(c, path.join(sdk, `tools/emulator/bin/em-cli${isSystemWin ? '.bat' : ''}`));\n        c.cli[CLI_TIZEN] = getRealPath(c, path.join(sdk, `tools/ide/bin/tizen${isSystemWin ? '.bat' : ''}`));\n        c.cli[CLI_SDB_TIZEN] = getRealPath(c, path.join(sdk, `tools/sdb${isSystemWin ? '.exe' : ''}`));\n    } else {\n        _logSdkWarning(c);\n    }\n};\n\nexport const checkAndConfigureWebosSdks = async (c) => {\n    logTask(`checkAndConfigureWebosSdks:${c.platform}`);\n    const sdk = c.files.workspace.config?.sdks?.WEBOS_SDK;\n    if (sdk) {\n        c.cli[CLI_WEBOS_ARES] = getRealPath(c, path.join(sdk, `CLI/bin/ares${isSystemWin ? '.cmd' : ''}`));\n        c.cli[CLI_WEBOS_ARES_PACKAGE] = getRealPath(c, path.join(sdk, `CLI/bin/ares-package${isSystemWin ? '.cmd' : ''}`));\n        c.cli[CLI_WEBOS_ARES_INSTALL] = getRealPath(c, path.join(sdk, `CLI/bin/ares-install${isSystemWin ? '.cmd' : ''}`));\n        c.cli[CLI_WEBOS_ARES_LAUNCH] = getRealPath(c, path.join(sdk, `CLI/bin/ares-launch${isSystemWin ? '.cmd' : ''}`));\n        c.cli[CLI_WEBOS_ARES_SETUP_DEVICE] = getRealPath(c, path.join(sdk, `CLI/bin/ares-setup-device${isSystemWin ? '.cmd' : ''}`));\n        c.cli[CLI_WEBOS_ARES_DEVICE_INFO] = getRealPath(c, path.join(sdk, `CLI/bin/ares-device-info${isSystemWin ? '.cmd' : ''}`));\n        c.cli[CLI_WEBOS_ARES_NOVACOM] = getRealPath(c, path.join(sdk, `CLI/bin/ares-novacom${isSystemWin ? '.cmd' : ''}`));\n    } else {\n        _logSdkWarning(c);\n    }\n};\n\nexport const checkAndConfigureSdks = async (c) => {\n    logTask(`checkAndConfigureSdks:${c.platform}`);\n\n    switch (c.platform) {\n        case ANDROID:\n        case ANDROID_TV:\n        case ANDROID_WEAR:\n            return checkAndConfigureAndroidSdks(c);\n        case TIZEN:\n        case TIZEN_MOBILE:\n        case TIZEN_WATCH:\n            return checkAndConfigureTizenSdks(c);\n        case WEBOS:\n            return checkAndConfigureWebosSdks(c);\n        default:\n            return true;\n    }\n};\n\nconst _getCurrentSdkPath = c => c.files.workspace?.config?.sdks?.[SDK_PLATFORMS[c.platform]];\n\nconst _isSdkInstalled = (c) => {\n    logTask(`_isSdkInstalled: ${c.platform}`);\n\n    if (!SDK_PLATFORMS[c.platform]) return true;\n\n    const sdkPath = _getCurrentSdkPath(c, c.platform);\n\n    return fs.existsSync(getRealPath(c, sdkPath));\n};\n\nconst _attemptAutoFix = async (c, engine) => {\n    const result = SDK_LOACTIONS[engine].find(v => fs.existsSync(v));\n    if (result) {\n        logSuccess(`Found existing ${c.platform} SDK location at ${chalk.white(result)}`);\n        const { confirm } = await inquirer.prompt({\n            type: 'confirm',\n            name: 'confirm',\n            message: 'Do you want to use it?'\n        });\n\n        if (confirm) {\n            try {\n                c.files.workspace.config.sdks[SDK_PLATFORMS[c.platform]] = result;\n                writeFileSync(c.paths.workspace.config, c.files.workspace.config);\n                await checkAndConfigureSdks(c);\n            } catch (e) {\n                logError(e);\n            }\n\n            return true;\n        }\n    }\n\n    const setupInstance = PlatformSetup(c);\n    return setupInstance.askToInstallSDK(engine);\n};\n\n\nexport const checkSdk = async (c) => {\n    logTask('checkSdk');\n    if (!_isSdkInstalled(c)) {\n        logWarning(`${c.platform} requires SDK to be installed. Your SDK path in ${chalk.white(c.paths.workspace.config)} does not exist: ${chalk.white(_getCurrentSdkPath(c))}`);\n\n        switch (c.platform) {\n            case ANDROID:\n            case ANDROID_TV:\n            case ANDROID_WEAR:\n                return _attemptAutoFix(c, 'android');\n            case TIZEN:\n            case TIZEN_MOBILE:\n            case TIZEN_WATCH:\n                return _attemptAutoFix(c, 'tizen');\n            case WEBOS:\n                return _attemptAutoFix(c, 'webos');\n            default:\n                return true;\n        }\n    }\n    return true;\n};\n"],"mappings":"4XAAA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;AAwBA;AACA;;;AAGA;;;AAGA;;AAEA,GAAMA,QAAO,CAAGC,OAAO,CAAC,IAAI,CAAC,CAACD,OAAO,EAAE;;AAEvC,GAAME,cAAa,CAAG;AAClBC,OAAO,CAAE;AACLC,aAAI,CAACC,IAAI,CAAC,uBAAuB,CAAC;AAClCD,aAAI,CAACC,IAAI,CAACL,OAAO,CAAE,qBAAqB,CAAC;AACzCI,aAAI,CAACC,IAAI,CAACL,OAAO,CAAE,mCAAmC,CAAC;AACvDI,aAAI,CAACC,IAAI,CAACL,OAAO,CAAE,2BAA2B,CAAC;AAC/CI,aAAI,CAACC,IAAI,CAAC,yCAAyC,CAAC,CACvD;;AACDC,KAAK,CAAE;AACHF,aAAI,CAACC,IAAI,CAAC,wBAAwB,CAAC;AACnCD,aAAI,CAACC,IAAI,CAACL,OAAO,CAAE,cAAc,CAAC,CACrC;;AACDO,KAAK,CAAE;AACHH,aAAI,CAACC,IAAI,CAAC,mBAAmB,CAAC;;AAEtC,CAAC;;AAED,GAAMG,eAAc,CAAG,QAAjBA,eAAc,CAAIC,CAAC,CAAK;AAC1B,GAAAC,kBAAU,UAASD,CAAC,CAACE,KAAK,CAACC,SAAS,CAACC,MAAM,wCAAuC;AACtF,CAAC;;AAEM,GAAMC,6BAA4B,CAAG,QAA/BA,6BAA4B,CAAUL,CAAC;AAChD,GAAAM,eAAO,kCAAiCN,CAAC,CAACO,QAAQ,CAAG;AAC/CC,GAAG,wBAAGR,CAAC,CAACS,KAAK,CAACN,SAAS,CAACC,MAAM,uCAAxB,sBAA0BM,IAAI,eAA9B,uBAAgCC,WAAW;AACvD,GAAIH,GAAG,CAAE;AACLR,CAAC,CAACY,GAAG,CAACC,+BAAoB,CAAC,CAAG,GAAAC,sBAAW,EAACd,CAAC,CAAEL,aAAI,CAACC,IAAI,CAACY,GAAG,sBAAsBO,kBAAW,CAAG,MAAM,CAAG,EAAE,EAAG,CAAC;AAC7Gf,CAAC,CAACY,GAAG,CAACI,0BAAe,CAAC,CAAG,GAAAF,sBAAW,EAACd,CAAC,CAAEL,aAAI,CAACC,IAAI,CAACY,GAAG,uBAAuBO,kBAAW,CAAG,MAAM,CAAG,EAAE,EAAG,CAAC;AACzGf,CAAC,CAACY,GAAG,CAACK,iCAAsB,CAAC,CAAG,GAAAH,sBAAW,EAACd,CAAC,CAAEL,aAAI,CAACC,IAAI,CAACY,GAAG,yBAAyBO,kBAAW,CAAG,MAAM,CAAG,EAAE,EAAG,CAAC;AAClHf,CAAC,CAACY,GAAG,CAACM,iCAAsB,CAAC,CAAG,GAAAJ,sBAAW,EAACd,CAAC,CAAEL,aAAI,CAACC,IAAI,CAACY,GAAG,yBAAyBO,kBAAW,CAAG,MAAM,CAAG,EAAE,EAAG,CAAC;AACtH,CAAC,IAAM;AACHhB,cAAc,CAACC,CAAC,CAAC;AACrB,CAAC,oEACJ,CAAC;;;AAEK,GAAMmB,2BAA0B,CAAG,QAA7BA,2BAA0B,CAAUnB,CAAC;AAC9C,GAAAM,eAAO,gCAA+BN,CAAC,CAACO,QAAQ,CAAG;AAC7CC,GAAG,yBAAGR,CAAC,CAACS,KAAK,CAACN,SAAS,CAACC,MAAM,uCAAxB,uBAA0BM,IAAI,eAA9B,uBAAgCU,SAAS;AACrD,GAAIZ,GAAG,CAAE;AACLR,CAAC,CAACY,GAAG,CAACS,6BAAkB,CAAC,CAAG,GAAAP,sBAAW,EAACd,CAAC,CAAEL,aAAI,CAACC,IAAI,CAACY,GAAG,8BAA8BO,kBAAW,CAAG,MAAM,CAAG,EAAE,EAAG,CAAC;AACnHf,CAAC,CAACY,GAAG,CAACU,oBAAS,CAAC,CAAG,GAAAR,sBAAW,EAACd,CAAC,CAAEL,aAAI,CAACC,IAAI,CAACY,GAAG,wBAAwBO,kBAAW,CAAG,MAAM,CAAG,EAAE,EAAG,CAAC;AACpGf,CAAC,CAACY,GAAG,CAACW,wBAAa,CAAC,CAAG,GAAAT,sBAAW,EAACd,CAAC,CAAEL,aAAI,CAACC,IAAI,CAACY,GAAG,cAAcO,kBAAW,CAAG,MAAM,CAAG,EAAE,EAAG,CAAC;AAClG,CAAC,IAAM;AACHhB,cAAc,CAACC,CAAC,CAAC;AACrB,CAAC,qEACJ,CAAC;;;AAEK,GAAMwB,2BAA0B,CAAG,QAA7BA,2BAA0B,CAAUxB,CAAC;AAC9C,GAAAM,eAAO,gCAA+BN,CAAC,CAACO,QAAQ,CAAG;AAC7CC,GAAG,yBAAGR,CAAC,CAACS,KAAK,CAACN,SAAS,CAACC,MAAM,uCAAxB,uBAA0BM,IAAI,eAA9B,uBAAgCe,SAAS;AACrD,GAAIjB,GAAG,CAAE;AACLR,CAAC,CAACY,GAAG,CAACc,yBAAc,CAAC,CAAG,GAAAZ,sBAAW,EAACd,CAAC,CAAEL,aAAI,CAACC,IAAI,CAACY,GAAG,iBAAiBO,kBAAW,CAAG,MAAM,CAAG,EAAE,EAAG,CAAC;AAClGf,CAAC,CAACY,GAAG,CAACe,iCAAsB,CAAC,CAAG,GAAAb,sBAAW,EAACd,CAAC,CAAEL,aAAI,CAACC,IAAI,CAACY,GAAG,yBAAyBO,kBAAW,CAAG,MAAM,CAAG,EAAE,EAAG,CAAC;AAClHf,CAAC,CAACY,GAAG,CAACgB,iCAAsB,CAAC,CAAG,GAAAd,sBAAW,EAACd,CAAC,CAAEL,aAAI,CAACC,IAAI,CAACY,GAAG,yBAAyBO,kBAAW,CAAG,MAAM,CAAG,EAAE,EAAG,CAAC;AAClHf,CAAC,CAACY,GAAG,CAACiB,gCAAqB,CAAC,CAAG,GAAAf,sBAAW,EAACd,CAAC,CAAEL,aAAI,CAACC,IAAI,CAACY,GAAG,wBAAwBO,kBAAW,CAAG,MAAM,CAAG,EAAE,EAAG,CAAC;AAChHf,CAAC,CAACY,GAAG,CAACkB,sCAA2B,CAAC,CAAG,GAAAhB,sBAAW,EAACd,CAAC,CAAEL,aAAI,CAACC,IAAI,CAACY,GAAG,8BAA8BO,kBAAW,CAAG,MAAM,CAAG,EAAE,EAAG,CAAC;AAC5Hf,CAAC,CAACY,GAAG,CAACmB,qCAA0B,CAAC,CAAG,GAAAjB,sBAAW,EAACd,CAAC,CAAEL,aAAI,CAACC,IAAI,CAACY,GAAG,6BAA6BO,kBAAW,CAAG,MAAM,CAAG,EAAE,EAAG,CAAC;AAC1Hf,CAAC,CAACY,GAAG,CAACoB,iCAAsB,CAAC,CAAG,GAAAlB,sBAAW,EAACd,CAAC,CAAEL,aAAI,CAACC,IAAI,CAACY,GAAG,yBAAyBO,kBAAW,CAAG,MAAM,CAAG,EAAE,EAAG,CAAC;AACtH,CAAC,IAAM;AACHhB,cAAc,CAACC,CAAC,CAAC;AACrB,CAAC,qEACJ,CAAC;;;AAEK,GAAMiC,sBAAqB,CAAG,QAAxBA,sBAAqB,CAAUjC,CAAC;AACzC,GAAAM,eAAO,2BAA0BN,CAAC,CAACO,QAAQ,CAAG,CAAC;;AAEvCP,CAAC,CAACO,QAAQ;AACT2B,kBAAO;AACPC,qBAAU;AACVC,uBAAY;;AAEZC,gBAAK;AACLC,uBAAY;AACZC,sBAAW;;AAEXC,gBAAK,mDALCnC,4BAA4B,CAACL,CAAC,CAAC,0CAI/BmB,0BAA0B,CAACnB,CAAC,CAAC;AAE7BwB,0BAA0B,CAACxB,CAAC,CAAC;;AAE7B,IAAI,uEAEtB,CAAC;;;;AAEF,GAAMyC,mBAAkB,CAAG,QAArBA,mBAAkB,CAAGzC,CAAC,iGAAIA,CAAC,CAACS,KAAK,CAACN,SAAS,uCAAjB,mBAAmBC,MAAM,uCAAzB,uBAA2BM,IAAI,eAA/B,uBAAkCgC,wBAAa,CAAC1C,CAAC,CAACO,QAAQ,CAAC,CAAC;;AAE5F,GAAMoC,gBAAe,CAAG,QAAlBA,gBAAe,CAAI3C,CAAC,CAAK;AAC3B,GAAAM,eAAO,sBAAqBN,CAAC,CAACO,QAAQ,CAAG;;AAEzC,GAAI,CAACmC,wBAAa,CAAC1C,CAAC,CAACO,QAAQ,CAAC,CAAE,MAAO,KAAI;;AAE3C,GAAMqC,QAAO,CAAGH,kBAAkB,CAACzC,CAAC,CAAEA,CAAC,CAACO,QAAQ,CAAC;;AAEjD,MAAOsC,YAAE,CAACC,UAAU,CAAC,GAAAhC,sBAAW,EAACd,CAAC,CAAE4C,OAAO,CAAC,CAAC;AACjD,CAAC;;AAED,GAAMG,gBAAe,CAAG,QAAlBA,gBAAe,CAAU/C,CAAC,CAAEgD,MAAM;AAC9BC,MAAM,CAAGxD,aAAa,CAACuD,MAAM,CAAC,CAACE,IAAI,CAAC,SAAAC,CAAC,QAAIN,YAAE,CAACC,UAAU,CAACK,CAAC,CAAC,GAAC;AAC5DF,MAAM;AACN,GAAAG,kBAAU,oBAAmBpD,CAAC,CAACO,QAAQ,qBAAoB8C,cAAK,CAACC,KAAK,CAACL,MAAM,CAAC,CAAG,CAAC;AACxDM,iBAAQ,CAACC,MAAM,CAAC;AACtCC,IAAI,CAAE,SAAS;AACfC,IAAI,CAAE,SAAS;AACfC,OAAO,CAAE;AACb,CAAC,CAAC,8CAJMC,OAAO,uBAAPA,OAAO;;AAMXA,OAAO;;AAEH5D,CAAC,CAACS,KAAK,CAACN,SAAS,CAACC,MAAM,CAACM,IAAI,CAACgC,wBAAa,CAAC1C,CAAC,CAACO,QAAQ,CAAC,CAAC,CAAG0C,MAAM;AACjE,GAAAY,wBAAa,EAAC7D,CAAC,CAACE,KAAK,CAACC,SAAS,CAACC,MAAM,CAAEJ,CAAC,CAACS,KAAK,CAACN,SAAS,CAACC,MAAM,CAAC,CAAC;AAC5D6B,qBAAqB,CAACjC,CAAC,CAAC;;AAE9B,GAAA8D,gBAAQ,eAAG,CAAC;;;AAGT,IAAI;;;;AAIbC,aAAa,CAAG,GAAAC,mBAAa,EAAChE,CAAC,CAAC;AAC/B+D,aAAa,CAACE,eAAe,CAACjB,MAAM,CAAC,4EAC/C;;;;AAGM,GAAMkB,SAAQ,CAAG,QAAXA,SAAQ,CAAUlE,CAAC;AAC5B,GAAAM,eAAO,EAAC,UAAU,CAAC,CAAC;AACfqC,eAAe,CAAC3C,CAAC,CAAC;AACnB,GAAAC,kBAAU,EAAID,CAAC,CAACO,QAAQ,oDAAmD8C,cAAK,CAACC,KAAK,CAACtD,CAAC,CAACE,KAAK,CAACC,SAAS,CAACC,MAAM,CAAC,qBAAoBiD,cAAK,CAACC,KAAK,CAACb,kBAAkB,CAACzC,CAAC,CAAC,CAAC,CAAG,CAAC;;AAElKA,CAAC,CAACO,QAAQ;AACT2B,kBAAO;AACPC,qBAAU;AACVC,uBAAY;;AAEZC,gBAAK;AACLC,uBAAY;AACZC,sBAAW;;AAEXC,gBAAK,mDALCO,eAAe,CAAC/C,CAAC,CAAE,SAAS,CAAC,0CAI7B+C,eAAe,CAAC/C,CAAC,CAAE,OAAO,CAAC;AAE3B+C,eAAe,CAAC/C,CAAC,CAAE,OAAO,CAAC;;AAE3B,IAAI;;;AAGhB,IAAI,wEACd,CAAC"}