{"version":3,"sources":["../../../src/platformTools/electron/index.js"],"names":["configureElectronProject","c","platform","MACOS","_generateICNS","configureProject","merge","require","Promise","resolve","reject","appFolder","templateFolder","bundleAssets","electronConfigPath","path","join","packagePath","appId","fs","existsSync","chalk","white","then","catch","e","pkgJson","packageJson","name","runtime","productName","version","description","author","license","main","browserWindow","width","height","webPreferences","nodeIntegration","browserWindowExt","browserWindowStr","JSON","stringify","pattern","override","localhost","port","macConfig","mac","entitlements","entitlementsInherit","hardenedRuntime","mas","provisioningProfile","electronConfig","directories","app","buildResources","output","files","electronConfigExt","buildElectron","exportElectron","maxErrorLength","program","buildPath","console","log","runElectron","bundleIsDev","_runElectronSimulator","isPortActive","logError","runElectronDevServer","elc","child","detached","env","process","stdio","on","code","exit","spawnError","error","unref","source","paths","appConfig","dirs","forEach","v","pf","dir","dest","p"],"mappings":"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","sourcesContent":["import path from 'path';\nimport fs from 'fs';\nimport chalk from 'chalk';\nimport { spawn } from 'child_process';\nimport { createPlatformBuild } from '..';\nimport { executeAsync } from '../../systemTools/exec';\nimport {\n    getAppFolder,\n    getAppVersion,\n    getAppTitle,\n    writeCleanFile,\n    getAppId,\n    getAppTemplateFolder,\n    getAppDescription,\n    getAppAuthor,\n    getAppLicense,\n    getConfigProp,\n    checkPortInUse,\n    resolveNodeModulePath,\n    waitForWebpack,\n    confirmActiveBundler\n} from '../../common';\nimport {\n    logTask,\n    logError,\n    logWarning,\n    logSuccess,\n    logInfo\n} from '../../systemTools/logger';\nimport { isPlatformActive } from '..';\nimport { isSystemWin } from '../../utils';\nimport { copyBuildsFolder, copyAssetsFolder } from '../../projectTools/projectParser';\nimport { MACOS } from '../../constants';\nimport {\n    buildWeb,\n    runWeb,\n    configureCoreWebProject\n} from '../web';\nimport {\n    mkdirSync, writeFileSync, readObjectSync, removeDirs\n} from '../../systemTools/fileutils';\n\nconst configureElectronProject = async (c, platform) => {\n    logTask(`configureElectronProject:${platform}`);\n\n    await copyAssetsFolder(c, platform, platform === MACOS ? _generateICNS : null);\n    await configureCoreWebProject(c, platform);\n    await configureProject(c, platform);\n    return copyBuildsFolder(c, platform);\n};\nconst merge = require('deepmerge');\n\nconst configureProject = (c, platform) => new Promise((resolve, reject) => {\n    logTask(`configureProject:${platform}`);\n\n    if (!isPlatformActive(c, platform, resolve)) return;\n\n    const appFolder = getAppFolder(c, platform);\n    const templateFolder = getAppTemplateFolder(c, platform);\n    const bundleAssets = getConfigProp(c, platform, 'bundleAssets') === true;\n    const electronConfigPath = path.join(appFolder, 'electronConfig.json');\n    const packagePath = path.join(appFolder, 'package.json');\n    const appId = getAppId(c, platform);\n\n    if (!fs.existsSync(packagePath)) {\n        logWarning(`Looks like your ${chalk.white(platform)} platformBuild is misconfigured!. let's repair it.`);\n        createPlatformBuild(c, platform)\n            .then(() => configureElectronProject(c, platform))\n            .then(() => resolve(c))\n            .catch(e => reject(e));\n        return;\n    }\n\n    const pkgJson = path.join(templateFolder, 'package.json');\n    const packageJson = readObjectSync(pkgJson);\n\n    packageJson.name = `${c.runtime.appId}-${platform}`;\n    packageJson.productName = `${getAppTitle(c, platform)}`;\n    packageJson.version = `${getAppVersion(c, platform)}`;\n    packageJson.description = `${getAppDescription(c, platform)}`;\n    packageJson.author = getAppAuthor(c, platform);\n    packageJson.license = `${getAppLicense(c, platform)}`;\n    packageJson.main = './main.js';\n\n    writeFileSync(packagePath, packageJson);\n\n    let browserWindow = { width: 1200, height: 800, webPreferences: { nodeIntegration: true } };\n    const browserWindowExt = getConfigProp(c, platform, 'BrowserWindow');\n    if (browserWindowExt) {\n        browserWindow = merge(browserWindow, browserWindowExt);\n    }\n    const browserWindowStr = JSON.stringify(browserWindow, null, 2);\n\n    if (bundleAssets) {\n        writeCleanFile(path.join(templateFolder, '_privateConfig', 'main.js'), path.join(appFolder, 'main.js'), [\n            { pattern: '{{PLUGIN_INJECT_BROWSER_WINDOW}}', override: browserWindowStr },\n        ]);\n    } else {\n        writeCleanFile(path.join(templateFolder, '_privateConfig', 'main.dev.js'), path.join(appFolder, 'main.js'), [\n            { pattern: '{{DEV_SERVER}}', override: `http://${c.runtime.localhost}:${c.runtime.port}` },\n            { pattern: '{{PLUGIN_INJECT_BROWSER_WINDOW}}', override: browserWindowStr },\n        ]);\n    }\n\n    const macConfig = {};\n    if (platform === MACOS) {\n        macConfig.mac = {\n            entitlements: path.join(appFolder, 'entitlements.mac.plist'),\n            entitlementsInherit: path.join(appFolder, 'entitlements.mac.plist'),\n            hardenedRuntime: true\n        };\n        macConfig.mas = {\n            entitlements: path.join(appFolder, 'entitlements.mas.plist'),\n            entitlementsInherit: path.join(appFolder, 'entitlements.mas.inherit.plist'),\n            provisioningProfile: path.join(appFolder, 'embedded.provisionprofile'),\n            hardenedRuntime: false\n        };\n    }\n\n    let electronConfig = merge({\n        appId,\n        directories: {\n            app: appFolder,\n            buildResources: path.join(appFolder, 'resources'),\n            output: path.join(appFolder, 'build/release')\n        },\n        files: [\n            '!build/release'\n        ],\n    }, macConfig);\n\n    const electronConfigExt = getConfigProp(c, platform, 'electronConfig');\n\n    if (electronConfigExt) {\n        electronConfig = merge(electronConfig, electronConfigExt);\n    }\n    writeFileSync(electronConfigPath, electronConfig);\n\n\n    resolve();\n});\n\nconst buildElectron = (c, platform) => {\n    logTask(`buildElectron:${platform}`);\n\n    return buildWeb(c, platform);\n};\n\nconst exportElectron = async (c, platform) => {\n    logTask(`exportElectron:${platform}`);\n    const { maxErrorLength } = c.program;\n    const appFolder = getAppFolder(c, platform);\n    const buildPath = path.join(appFolder, 'build');\n\n    if (fs.existsSync(buildPath)) {\n        console.log(`removing old build ${buildPath}`);\n        await removeDirs([buildPath]);\n    }\n\n    await executeAsync(c, `npx electron-builder --config ${path.join(appFolder, 'electronConfig.json')}`);\n\n    logSuccess(`Your Exported App is located in ${chalk.white(path.join(appFolder, 'build/release'))} .`);\n};\n\nconst runElectron = async (c, platform, port) => {\n    logTask(`runElectron:${platform}`);\n\n    const bundleIsDev = getConfigProp(c, platform, 'bundleIsDev') === true;\n    const bundleAssets = getConfigProp(c, platform, 'bundleAssets') === true;\n\n    if (bundleAssets) {\n        await buildElectron(c, platform, bundleIsDev);\n        await _runElectronSimulator(c, platform);\n    } else {\n        const isPortActive = await checkPortInUse(c, platform, port);\n        if (!isPortActive) {\n            logInfo(\n                `Looks like your ${chalk.white(platform)} devServer at port ${chalk.white(\n                    port\n                )} is not running. Starting it up for you...`\n            );\n            waitForWebpack(c, port)\n                .then(() => _runElectronSimulator(c, platform))\n                .catch(logError);\n            // await _runElectronSimulator(c, platform);\n            await runElectronDevServer(c, platform, port);\n        } else {\n            await confirmActiveBundler(c);\n            await _runElectronSimulator(c, platform);\n        }\n    }\n};\n\nconst _runElectronSimulator = async (c) => {\n    logTask(`_runElectronSimulator:${c.platform}`);\n    const appFolder = getAppFolder(c, c.platform);\n    const elc = resolveNodeModulePath(c, 'electron/cli.js');\n\n    const child = spawn('node', [elc, path.join(appFolder, '/main.js')], {\n        detached: true,\n        env: process.env,\n        stdio: 'inherit',\n    })\n        .on('close', code => process.exit(code))\n        .on('error', spawnError => console.error(spawnError));\n\n    child.unref();\n};\n\nconst runElectronDevServer = async (c, platform, port) => {\n    logTask(`runElectronDevServer:${platform}`);\n\n    return runWeb(c, platform, port);\n};\n\nconst _generateICNS = (c, platform) => new Promise((resolve, reject) => {\n    logTask(`_generateICNS:${platform}`);\n\n    let source;\n\n    if (c.paths.appConfig.dirs) {\n        c.paths.appConfig.dirs.forEach((v) => {\n            const pf = path.join(v, `assets/${platform}/AppIcon.iconset`);\n            if (fs.existsSync(pf)) {\n                source = pf;\n            }\n        });\n    } else if (c.paths.appConfig.dir) {\n        source = path.join(c.paths.appConfig.dir, `assets/${platform}/AppIcon.iconset`);\n    }\n\n    const dest = path.join(getAppFolder(c, platform), 'resources/icon.icns');\n\n    if (!fs.existsSync(source)) {\n        logWarning(`Your app config is missing ${chalk.white(source)}. icon.icns will not be generated!`);\n        resolve();\n        return;\n    }\n\n    mkdirSync(path.join(getAppFolder(c, platform), 'resources'));\n\n    const p = [\n        '--convert',\n        'icns',\n        source,\n        '--output',\n        dest\n    ];\n    try {\n        executeAsync(c, `iconutil ${p.join(' ')}`);\n        resolve();\n    } catch (e) {\n        reject(e);\n    }\n});\n\nexport { configureElectronProject, runElectron, buildElectron, exportElectron, runElectronDevServer };\n"],"file":"index.js"}